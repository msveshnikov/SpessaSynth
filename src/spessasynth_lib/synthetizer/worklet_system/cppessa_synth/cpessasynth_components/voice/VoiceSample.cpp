//
// Created by spessasus on 21.05.24.
//

#include <emscripten/emscripten.h>
#include "VoiceSample.h"

/**
 * @param sampleID the id of the sample
 * @param playbackRate the calculated playback rate of the sample
 * @param rootKey sample's root key
 * @param loopStart calculated (offset) loop start index
 * @param loopEnd calculated (offset) loop end index
 * @param startIndex calculated (offset) start index
 * @param endIndex calculaded (offset) end index
 * @param loopingMode
 */
EMSCRIPTEN_KEEPALIVE
VoiceSample::VoiceSample(unsigned int sampleID,
                         float playbackRate,
                         unsigned int rootKey,
                         unsigned int loopStart,
                         unsigned int loopEnd,
                         unsigned int startIndex,
                         unsigned int endIndex,
                         char loopingMode) {
    this->cursor = (float)startIndex; // set the cursor to start index
    this->sampleID = sampleID;
    this->playbackRate = playbackRate;
    this->rootKey = rootKey;
    this->loopStart = loopStart;
    this->loopEnd = loopEnd;
    this->end = endIndex;
    this->loopingMode = loopingMode;

}

/*

 ⠀⠀⠀⠀⠀⠀⠀⠀⡀⣠⡠⡦⣲⣺⡺⡮⣗⢯⣳⢯⡳⣯⡳⡯⣞⣞⡖⣦⣢⡠⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⣄⢦⣳⢽⣺⢽⢝⣗⣗⡯⣯⢾⡽⣮⣳⢽⡺⡽⣝⣞⢮⡻⣺⢺⡺⡽⣕⢦⡀⡀⠀⠀⠀⠀⠀⠄⠐⠀⠀⠀⠀⠀⠀⠀⠄⠁⠠⠀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⢀⠠⢀⢢⣗⣗⣟⢮⣻⢮⣯⣟⣾⣳⢿⡽⡯⣯⢷⣻⣽⣯⣟⡮⡮⡳⣝⢮⡳⣝⢮⣫⡳⣝⢖⡄⠀⠀⠄⠡⠐⠈⠀⠀⠈⠀⠀⠠⠀⠀⠀⠐⢀⠠⠀⠠⠀⠠⠀⠀⠐⢀⠐⠀⠀⠠⠀⠀⠄⠀
⠀⢠⣪⣗⣗⢷⢽⢽⣺⡳⡽⣷⡻⡚⠋⠉⠈⠈⠁⠁⠓⠝⡷⣟⡮⡯⡺⡵⣝⢮⡳⡵⣝⢮⡳⣝⡔⢀⠊⠄⠂⡀⢁⠈⠀⡀⠠⠀⠀⡀⠁⡈⠀⡀⠂⠀⠀⠀⠀⠀⡀⢀⠂⠄⢀⠀⠀⠀⠀⠀
⢨⣺⣺⣺⣪⢯⢯⣗⢷⡝⣞⢮⡣⡀⠀⠀⢀⠠⠀⠀⠀⠀⠈⢝⣯⣞⢽⢺⣪⡳⣝⢞⢮⡳⣝⢮⢞⣆⠇⡁⠄⠄⠀⠄⠁⢀⠀⠂⠁⠀⠄⠀⠂⡀⠄⠡⠀⠀⠂⠁⠀⠄⢊⠪⡐⢐⠀⠁⠀⠀
⢜⣞⣞⣞⢮⢯⢷⢽⢕⢯⢮⡳⣝⢮⡂⠀⠀⠀⠀⠀⠀⠂⠀⠀⢳⣏⢗⣝⢮⣺⡪⣏⣗⣝⢮⡳⣻⣺⢨⢐⠠⠈⠄⠂⢈⠀⠠⠈⡀⢁⠀⡁⠐⠠⢈⠐⠀⠀⠀⠀⠀⠨⠀⠠⠈⠄⠀⠀⠀⠀
⢹⣺⣺⣪⢯⢯⢯⡺⣝⢵⡳⣝⢮⣫⣯⠄⠀⠀⢀⠠⠀⠀⠀⠀⠐⣗⡝⡮⡳⡵⣝⢮⡲⡳⡳⣝⢮⢞⡕⡔⡨⠨⠠⡁⡂⠌⠠⢁⠐⡀⠂⠄⠅⠅⡂⠁⠀⠀⠀⠄⠀⠨⠐⠀⠁⠀⠀⠀⠀⠁
⢘⣗⣗⡽⡽⣝⢵⡫⣞⢵⢝⡮⡳⡵⣿⣏⠀⠀⠀⠀⠀⠀⠈⠀⠐⡵⣣⡫⡝⣎⢮⡳⣝⣝⢵⡳⡹⡇⠱⡱⡨⢌⠢⡂⡂⢅⢑⢐⢐⠄⢅⠅⢅⠕⡀⠄⠀⠐⠀⠀⢀⢐⠀⡁⠌⠀⠀⠀⠁⠀
⠀⠸⣺⡺⣝⢮⡳⣝⢮⣫⡳⣝⡽⣽⣻⠇⠀⠀⠄⠀⠀⠄⠀⠀⡐⣝⢖⢵⢹⡸⡜⡮⡺⣜⢵⢝⢽⢁⠀⡈⠎⣎⢪⠰⡨⢢⢑⢔⢡⢊⢢⠡⠑⠀⠀⠀⠀⠀⠀⠀⠄⢂⠀⠠⢀⢀⠀⠐⠀⠀
⢀⠀⠀⠫⢮⡳⣝⣮⣳⢵⡽⣺⡽⣯⠛⠈⠀⠀⠀⠀⠀⠀⢀⠀⢜⡕⣝⢜⢵⢱⡣⡳⡕⡵⡱⡽⡝⠠⣿⡂⠀⠐⢑⠕⢕⠱⠱⡸⠰⠑⠁⠁⠀⠀⢀⠀⠠⠀⠈⠀⠕⠠⣸⣾⠻⠻⢻⢷⣄⠀
⠀⠀⠀⠀⠈⠚⠳⢗⡯⡿⠽⠏⠏⠂⠀⢀⠀⠠⠀⠈⠀⠀⠀⢠⣫⣺⣜⢵⢹⢜⣎⣧⡫⡮⣝⣾⡠⢐⣿⡅⣄⣴⣅⣇⠡⠡⡃⠢⣢⣰⣰⣰⡠⡂⠄⠠⣠⢄⢄⣬⣌⠸⡻⠅⠀⠀⠀⢹⣷⠂
⠀⠀⠀⠐⠀⠀⠀⠀⠀⠀⠀⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⢀⢇⢧⣫⣿⢧⢫⣪⣿⣿⣺⣺⣻⣿⢍⢎⣿⣟⠏⠝⡹⢿⡧⠑⢈⢾⢟⠙⠉⠫⢻⣷⠈⠄⣽⣿⠫⡋⢇⢂⠂⠁⠀⠠⣰⡵⠏⠀
⢀⠀⠁⠀⠀⠀⠐⠀⠀⠠⠀⠀⠀⠀⠠⠀⠀⠄⠀⢀⠁⣄⢮⢳⡱⡕⣿⣯⢺⣺⣟⣾⣟⢎⣾⢯⠢⡣⣿⡇⢌⢂⠐⢽⡯⠂⠐⢈⣠⣤⣵⣬⣾⣿⢐⢐⣺⡯⠊⠐⠁⠀⠀⠀⢄⣿⠝⠈⠀⠀
⠀⠀⠀⠀⠀⠂⠀⠀⢀⠀⠀⠀⠀⠂⠀⠀⠀⠀⠠⢐⢐⡸⡜⣎⢮⡚⡮⣿⣷⡿⡟⡺⣻⣴⡿⡕⢕⢜⣿⡣⠂⢂⠈⢾⣟⢀⢱⣿⠋⠃⠅⠅⣺⣿⠐⠀⣺⡯⠀⠀⠀⠀⢀⠠⠘⠏⠂⠀⠀⢀
⠀⠀⠀⠈⠀⠀⠀⡀⠀⠀⠀⠈⠀⠀⠀⢀⠀⠁⠠⣑⢴⢕⢇⢧⡣⡯⣾⢻⡿⡏⠊⠈⢻⣿⠑⠀⠀⢕⣿⢕⠈⠄⠌⣺⡯⠀⡐⢿⢷⣵⣴⢯⠟⣿⠄⠀⢽⡯⠀⠀⠀⡀⠀⠀⢴⣮⠀⠀⠀⠀
⠀⠀⠁⠀⠀⠠⠀⠀⠀⠀⠐⠀⠀⠠⠀⠀⠀⢠⢕⡗⡧⡳⣝⡷⡝⠍⠂⠀⠈⠀⠀⠀⢀⠀⠀⡀⠀⢕⢈⢂⠂⠡⠐⠀⡈⢀⠀⠄⠁⠡⢈⠐⠀⠀⠁⠀⠈⠀⠀⠀⡀⠀⠀⠀⠀⠀⠀⡀⠈⠀
⠀⠂⠀⠀⠄⠀⠀⠀⠀⠐⠀⠀⠀⠀⠀⠀⡌⡮⡳⣝⢾⡽⠫⠊⠀⠀⠀⠀⠀⠀⠀⡀⠀⠀⠀⠀⠠⡑⡐⢐⠈⠄⠐⠀⠄⠠⠀⠂⢈⠀⡂⡈⠀⢀⠠⠀⠀⠀⡀⠁⠀⠀⠀⠐⠈⠀⠀⠀⠀⠀
⠀⠀⠀⢀⠀⠀⠀⠈⠀⠀⠀⡀⠀⠁⠀⣜⢮⡫⣽⣺⡝⠈⠀⠀⠀⠀⠀⠀⠀⠂⠁⠀⠀⠀⠐⠀⢐⠅⡂⡂⠄⠡⢀⠁⠄⠂⢀⠁⠠⠀⠄⢂⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠀⠀⠀⠀⠐⠈
⠀⠀⢀⠀⠀⠀⠈⠀⠀⢀⠀⠀⠀⠀⡰⣕⢗⡽⣺⡗⠀⠀⠀⠀⢀⠀⠠⠐⠀⠀⠀⠀⠀⠀⡀⠀⠢⡁⡂⡂⠅⠨⢀⠂⢂⠐⡀⠂⡂⠨⠐⡀⠂⠀⠀⠀⠀⠐⠀⠀⠠⠀⠁⠀⠀⠀⠈⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠄⠀⠀⠀⠀⠀⠠⠐⢼⡳⣝⢾⢽⡊⠀⠀⠁⠀⠀⠀⠀⠀⠀⠀⢀⠠⠐⠀⠀⠀⢅⢂⢂⠢⢁⠌⠠⠈⠄⠂⢂⢁⠐⡈⠄⠂⡁⠀⠀⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⢀⠠⠀⠀⠐
⠀⠀⠂⠀⠈⠀⠀⠀⠈⠀⠀⠠⠀⢐⢽⡺⡪⡯⣿⠀⠀⠀⢀⠠⠀⠀⠄⠀⠀⡀⠀⠀⠀⠀⠀⠀⡢⢂⠢⢑⢐⠨⠠⢑⠨⢈⠄⡐⢀⠂⠄⠡⢀⠀⠀⠐⠀⠀⠀⠁⠀⠀⠂⠀⠈⠀⠀⠀⠀⠀
⠁⠀⠀⠀⡀⠀⢀⠠⠀⠀⠠⠀⠀⢐⢯⣞⢽⢽⣽⠂⠀⢀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⢌⠢⠨⢐⢐⠨⠨⡂⡪⡐⠌⡐⢐⠈⠄⡁⢂⠀⠀⢀⠀⠠⠀⠀⠄⠂⠀⠀⠀⠀⠀⠀⠀⠀
⠄⠀⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⣟⡮⣯⡳⣟⠆⠀⠀⠀⠀⠀⡀⠄⠂⠁⠀⠀⠀⠁⠀⠁⠠⡁⡂⠌⠠⠠⢈⠢⡱⠰⡈⡂⢂⠂⠨⢀⠂⠂⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠀⠀⠈⠀⠀
⠀⠀⠠⠀⠀⠀⢀⠀⠀⠠⠐⠀⠐⠈⣳⢽⢮⢯⢿⡅⠀⠀⠠⠐⠀⠀⠀⠀⠀⠀⠀⠁⠀⠀⠀⡐⡐⡐⠈⠄⠡⢐⠨⠊⠀⠕⠌⢄⠨⠐⢀⠨⠐⡀⠀⠠⠀⠠⠐⠀⠀⠠⠀⠂⠀⠀⠐⠀⠀⢀
⠀⠀⠀⠀⠀⠈⠀⠀⠀⠀⠀⠀⠀⠀⠉⠉⠑⠉⠁⠀⠄⠂⠀⠀⠀⠀⠀⠀⠀⠀⡀⠀⠠⠐⠀⡐⡐⠄⠡⢈⠐⠠⡃⠁⠀⠨⡑⡐⠄⠡⠐⡀⠅⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠄⠀⠀⠀
⠀⠀⠁⠀⠐⠀⠀⠀⠀⠐⠀⠀⠠⠀⠀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠄⠀⠂⠁⠀⠀⠀⠀⢀⠢⠈⠄⡁⠂⠌⡢⠑⠀⠀⠠⢑⠄⠅⡁⢂⠐⠠⢁⠀⠀⠂⠀⠀⠄⠐⠀⠀⠂⠀⠀⠀⠀⠀⠂
⠀⠠⠀⠀⡀⠀⢀⠀⠁⠀⠀⠀⠀⠀⠀⠀⢀⠠⠐⡀⡀⠂⠀⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⡀⠐⢌⠌⡂⠄⠡⠡⡘⠄⠐⠀⠀⠱⡨⢐⢀⠂⠌⡐⠠⠀⠀⠀⢀⠀⠀⠀⠀⠀⠀⠀⠈⠀⠈⠀⠀
⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠁⠀⠈⡠⣜⣖⣟⢟⡽⡽⣳⢧⣢⠀⠀⠀⠀⠀⢀⠀⠄⠀⠀⠨⡂⡂⠢⠨⢐⠡⡊⡀⠀⠀⠀⢑⠌⠔⡐⠨⢐⠠⢑⠀⠀⠈⠀⠀⠀⠀⠐⠀⠈⠀⠀⠀⠀⡀⠀
⠀⠀⠀⠁⠀⠀⠄⠀⠐⠈⠀⠀⣄⡧⣟⣾⣳⢯⡿⡽⣯⡯⣯⡻⡯⣆⠀⠐⠈⠀⠀⠀⠀⠀⢐⠬⡨⢊⠌⡂⡑⡔⠀⠀⠀⠠⠐⠅⠕⠨⠨⢐⠨⢐⠀⠀⠀⠀⠀⡀⠐⠀⠀⠀⠀⡀⠈⠀⠀⠀
⠀⡀⠄⠀⠠⠀⠀⠀⠀⠀⠠⣪⡷⣟⣟⡾⣽⣽⢽⡯⣷⣻⣽⢽⡽⣞⡆⠀⠀⠀⠀⠀⠀⡀⠠⡑⢌⠢⡑⢌⢜⠀⠀⠀⠀⠀⠀⡑⡅⢅⢑⠄⡑⡐⠀⠀⠈⠀⠀⠀⠀⠀⠀⠀⠁⠀⠀⠀⠀⠀
⠁⠀⠀⠀⠀⠀⠀⠐⠈⠀⣽⢽⣽⣻⣞⣯⢷⡯⣿⢽⣻⣺⡽⣯⢿⡽⣇⠂⠀⠀⠀⠄⠀⠀⠀⣊⠢⡑⢌⠢⡒⠀⠀⠀⠐⠀⠀⠨⠢⡡⠂⢌⢐⢐⠀⠀⠀⡀⠠⠀⠀⠄⠈⠀⠀⠀⠀⡀⠐⠀
⠀⠀⠀⠀⢀⠀⠂⠀⠀⠀⣿⢽⣞⣷⣻⣞⣯⢿⡽⣽⣳⡯⡿⣽⢽⣽⡣⠀⠀⠀⢀⠀⠀⢀⠀⠢⡣⡑⠅⠕⡌⠀⠀⠁⠀⠀⠀⢈⢪⠠⡑⠄⢅⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⠀⠀⠀⠀
⡀⠠⠀⠂⠀⠀⠀⠀⠀⠈⢞⣯⡷⣷⣳⣟⡾⡯⡿⣽⣞⣯⢿⣽⣻⣞⠆⠀⠀⠀⠀⠀⠀⠀⢀⠑⢌⠌⡊⠕⡐⠀⠀⠀⠄⠀⠁⠀⡢⠡⢂⢑⠨⠐⠀⠀⠐⠀⠀⠀⠄⠀⠐⠀⠐⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠁⠀⠑⢯⡯⣷⣻⢾⢽⡯⣟⣷⣻⣞⣟⣾⣳⠣⠀⠀⠄⠈⠀⡀⢈⠐⠄⡑⡐⡐⠌⡂⡢⠀⠠⠀⡀⢀⠠⠀⡌⢌⠐⠄⠌⠄⡀⠄⠀⠀⠠⠀⠀⠀⠀⠀⠀⠀⠀⡀⠈⠀
⠀⠀⠀⠀⡀⠀⠈⠀⠀⢀⠀⠈⠝⢗⡯⡿⡽⡯⣟⣞⣗⣷⣻⢺⢪⢐⢈⠄⡂⠌⡠⢐⢐⢅⠅⠄⠄⢄⢑⢌⢆⢊⠄⠂⠄⠠⠀⠌⡌⠢⠁⠡⠐⠀⠀⠀⠀⠀⠀⠀⠀⠀⠁⠀⠐⠀⠁⠀⠀⠀
Clion recommended so i added this
 */
VoiceSample::~VoiceSample() = default;
